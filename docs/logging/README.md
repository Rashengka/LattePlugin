# Latte Plugin Logging System

This directory contains log files generated by the Latte Plugin during development and testing.

## Log File Structure

### Normal Execution

During normal execution (not in test mode), log files are placed directly in this directory with the following naming convention:

```
latte_plugin_TIMESTAMP_TYPE.log
```

Where:
- `TIMESTAMP` is the date and time when the logging session started (format: YYYY-MM-DD_HH-MM-SS)
- `TYPE` is the type of log (e.g., `latte_debug`, `validation_errors`)

Example:
```
latte_plugin_2025-07-23_12-09-03_latte_debug.log
latte_plugin_2025-07-23_12-09-03_validation_errors.log
```

### Test Execution

During test execution, logs are organized in a hierarchical folder structure to make it easier to identify which logs correspond to which tests:

1) Per-test plugin logs (debug/validation):
```
log/test_TIMESTAMP/
  SimpleClassName/
    testMethod.latte_debug.log
    testMethod.validation_errors.log
```

2) Per-method full console capture (stdout + stderr):
```
log/test_TIMESTAMP/
  SimpleClassName/
    testMethod.console.log
```

Where:
- `TIMESTAMP` is the date and time when the test was run (format: YYYY-MM-DD_HH-MM-SS)
- `SimpleClassName` is the test class name (including the "Test" suffix if present)
- `testMethod.latte_debug.log` and `testMethod.validation_errors.log` are LatteLogger plugin logs per test method

Examples:
```
log/test_2025-07-23_12-32-58/
  LatteLoggerTest/
    testDebugLogging.latte_debug.log
    testValidationErrorLogging.validation_errors.log
  Latte4xCompletionTest/
    testLatte4xMacroCompletion.console.log
```

## Log Types

The Latte Plugin generates the following types of log files:

1. **latte_debug.log**: Contains debug messages, information, warnings, and errors
2. **validation_errors.log**: Contains validation errors encountered during parsing and validation

## Configuration

Logging is enabled only in development mode and is disabled in production builds. This is controlled by the `latte.plugin.production` system property.

The log directory can be configured using the `latte.plugin.log.dir` system property. If not specified, it defaults to the `log` directory in the project root.

## Test Mode

Test mode is automatically detected when running tests via Gradle. This is controlled by the `latte.plugin.test.mode` system property, which is set to `true` during test execution.

## Analyzing test failures and timeouts

When a test fails or times out, always inspect the following in order:
1. Summary: log/test_YYYY-MM-DD_HH-MM-SS/test_YYYY-MM-DD_HH-MM-SS.log – contains per-test timing/memory lines and a summary.
2. Full console for the specific test method: log/test_YYYY-MM-DD_HH-MM-SS/<SimpleClassName>/<method>.console.log – complete stdout+stderr with headers/footers, useful for environment warnings and stack traces not present in HTML.
3. Per-test plugin logs: log/test_YYYY-MM-DD_HH-MM-SS/<TestName_method>/latte_plugin_TIMESTAMP_*.log – LatteLogger debug/validation details captured inside the plugin layer.

Note: The console prints "Command output logged to: ..." with the absolute path to the summary log, which helps locate the current run's folder quickly.